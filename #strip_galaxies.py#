import h5py
import caesar
import argparse

parser = argparse.ArgumentParser()
parser.add_argument('ds')
parser.add_argument('caesar')
args = parser.parse_args()

obj = caesar.load(args.caesar, load_limit=10)

glist = obj.galaxies[0].glist
slist = obj.galaxies[0].slist

with h5py.File(args.ds, 'r') as input_file, h5py.File('/ufrc/narayanan/s.lower/box_test/snap305.galaxy0.', 'w') as output_file:
    output_file.copy(input_file['Header'], 'Header')

    output_file.create_group('PartType0')
    for k in input_file['PartType0']:
        output_file['PartType0'][k] = input_file['PartType0'][k][:][glist]

    output_file.create_group('PartType4')
    for k in input_file['PartType4']:
        output_file['PartType4'][k] = input_file['PartType4'][k][:][slist]

